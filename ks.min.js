// Ks Â© 2014 Andrey Polischuk
// https://github.com/andrepolischuk/ks
!function(){"use strict";function f(a){return d[a]||a.toUpperCase().charCodeAt(0)}function h(a){delete g.keys[a.keyCode]}function i(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,function(){c(window.event)})}function j(a,b){var c=!a.target.id.length&&!a.target.tag.length||a.target.id.length&&a.target.id===b.target.id||a.target.tag.length&&a.target.tag===b.target.tag||!1,d=0,e=0;for(var f in b.keys)b.keys.hasOwnProperty(f)&&(d+=f in a.keys?1:0);for(f in a.keys)a.keys.hasOwnProperty(f)&&e++;return c&&d===e&&a.altKey===b.altKey&&a.ctrlKey===b.ctrlKey&&a.shiftKey===b.shiftKey}function k(a){if(!(a.keyCode in g.keys)){(a.keyCode<16||a.keyCode>18)&&(g.keys[a.keyCode]=!0),a.target=a.target||a.srcElement,g.target.id=a.target.id.length?"#"+a.target.id:"",g.target.tag=a.target.tagName.toLowerCase(),g.altKey=a.altKey,g.ctrlKey=a.ctrlKey,g.shiftKey=a.shiftKey;for(var c=0;c<b.length;c++)j(b[c],g)&&b[c].fn.call(a.target,b[c])}}function l(a){var b={};b.comb=a.replace(/\s/g,""),a=a.split("+"),b.keys={},b.altKey=!1,b.ctrlKey=!1,b.shiftKey=!1;for(var d=0;d<a.length;d++)a[d]in c?(b.altKey=b.altKey||"alt"===a[d]||"option"===a[d],b.ctrlKey=b.ctrlKey||"ctrl"===a[d]||"control"===a[d],b.shiftKey=b.shiftKey||"shift"===a[d]):b.keys[f(a[d])]=a[d];return b}function m(a){var b={};return b.id="",b.tag="",b[/^#.+$/g.test(a)?"id":"tag"]=a,b}function n(a,c,d){var e=l(a);e.target=m(c),e.fn=d,b.push(e)}function o(a,b,c){c="function"==typeof b?b:c,b="string"==typeof b?b:"","function"==typeof c&&"string"==typeof a&&n(a,b,c)}for(var b=[],c={ctrl:17,control:17,alt:18,option:18,shift:16},d={escape:27,esc:27,"`":192,"-":189,"=":187,backspace:8,tab:9,"\\":220,"[":219,"]":221,";":186,"'":222,enter:13,"return":13,",":188,".":190,"/":191,space:32,pause:19,insert:45,"delete":46,home:36,end:35,pageup:33,pagedown:34,left:37,up:38,right:39,down:40},e=1;20>e;e++)d["F"+e]=111+e;var g={};g.target={},g.keys={},o.remove=function(a,c){if("string"==typeof a){var d=l(a);d.target=m(c);for(var e=0;e<b.length;e++)j(b[e],d)&&(b.splice(e,1),e--)}},i(document,"keydown",k),i(document,"keyup",h),"function"==typeof define&&define.amd?define([],function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:this.ks=o}.call(this);
